<label class="text-xs font-bold opacity-60 -mb-3 tracking-wider">
  About This Project
</label>
<p class="px-3 text-base font-semibold opacity">
  {{.Description}}
</p>

<div class="flex flex-col gap-2">
  <label class="text-xs font-bold opacity-60 tracking-wider">
    Active Apps
  </label>

  {{with .Apps}}
  <div class="flex flex-col gap-2">
    {{range .}}
    <a href="{{host}}/app/{{.ID}}" class="flex items-center justify-between p-2 rounded-lg bg-base-200 hover:bg-base-300 transition" hx-boost="true">
      <div class="flex items-center gap-2">
        <div class="flex items-center justify-center w-8 h-8 rounded bg-primary/20 text-primary">
          <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
        </div>
        <span class="font-medium">{{.Name}}</span>
      </div>
      <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" height="1em" width="1em"
        xmlns="http://www.w3.org/2000/svg" class="opacity-40">
        <path
          d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z">
        </path>
      </svg>
    </a>
    {{end}}
  </div>

  {{with auth.CurrentUser}}
  {{if eq .ID $.OwnerID}}
  <button class="btn btn-sm btn-primary mt-2" _="on click call launch_app_modal.showModal()">
    Launch an App
  </button>
  {{end}}
  {{end}}
  {{else}}
  <div class="card bg-base-200 border border-white/10">
    <div class="card-body">
      <p class="text-sm opacity-80">No apps launched yet</p>

      {{with auth.CurrentUser}}
      {{if eq .ID $.OwnerID}}
      <button class="btn btn-sm btn-primary mt-2" _="on click call launch_app_modal.showModal()">
        Launch an App
      </button>
      {{end}}
      {{end}}
    </div>
  </div>
  {{end}}
</div>

<div class="flex flex-col gap-2">
  <label class="text-xs font-bold opacity-60 tracking-wider">
    User Comments
  </label>

  {{with auth.CurrentUser}}
  <form class="flex flex-col w-full" hx-post="{{host}}/comment" hx-target=".error">
    <input type="hidden" name="subject_id" value="{{$.ID}}">
    <input type="hidden" name="subject_type" value="repo">
    <textarea required name="content" class="textarea w-full"
      placeholder="Leave a comment for this project..."></textarea>
    <div class="flex items-center justify-between px-4 pt-2">
      <span class="text-sm font-semibold opacity-60">
        @{{.Handle}}
      </span>

      <button class="btn btn-xs btn-secondary">
        Post
      </button>
    </div>

    <div class="error"></div>
  </form>
  {{end}}

  {{$user := auth.CurrentUser}}
  {{range $comment := .Comments}}
  <div class="flex flex-col gap-2 w-full py-2">
    <div class="chat chat-start">
      <div class="chat-bubble w-full shadow max-w-none bg-neutral/60 min-h-20 p-4">
        {{.Content}}
      </div>
    </div>

    {{with .User}}
    <div class="flex items-center gap-2 px-2">
      <div class="avatar">
        <div class="w-5 p-0.5 bg-base-100 shadow-xl rounded-full">
          <img src="{{.Avatar}}" alt="{{.Name}}" class="rounded-full">
        </div>
      </div>

      <span class="text-xs font-semibold opacity-70">
        @{{.Handle}}
      </span>

      {{with $user}}
      {{if or (eq .ID $comment.UserID) $user.IsAdmin}}
      <div class="dropdown dropdown-end ml-auto">
        <div tabindex="0" role="button" class="btn btn-sm btn-ghost">Ô∏è
          <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" height="1em"
            width="1em" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z">
            </path>
          </svg>
        </div>

        <ul tabindex="-1" class="dropdown-content menu menu-sm bg-base-100 rounded-box z-1 w-52 p-2 shadow-sm">
          <li>
            <a hx-put="{{host}}/comment/{{$comment.ID}}" hx-prompt="Enter new content:">
              Edit
            </a>
          </li>
          <li>
            <a hx-delete="{{host}}/comment/{{$comment.ID}}" hx-confirm="Are you sure you want to delete this comment?">
              Delete
            </a>
          </li>
        </ul>
      </div>
      {{end}}
      {{end}}
    </div>
    {{end}}
  </div>
  {{end}}
</div>