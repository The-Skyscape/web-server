{{/* editor-block.html - Renders a single block in the thought editor */}}

<div class="editor-block group flex gap-2 items-start"
     data-block-id="{{.ID}}"
     data-type="{{.Type}}"
     data-position="{{.Position}}">

  <!-- Drag handle -->
  <div class="block-handle cursor-grab opacity-0 group-hover:opacity-60 pt-1 text-white/40 select-none">⋮⋮</div>

  {{if eq .Type "image"}}
  <!-- Image block -->
  <div class="flex-1">
    {{with .File}}
    <img src="{{host}}/file/{{.ID}}" class="max-w-full rounded-lg" alt="{{$.Content}}">
    {{end}}
    <input type="text" value="{{.Content}}" placeholder="Add a caption..."
      class="input input-sm input-ghost w-full mt-2 text-white/60"
      _="on change call thoughtEditor.updateBlock('{{.ID}}', { content: my value })">
  </div>

  {{else if eq .Type "file"}}
  <!-- File block -->
  <a href="{{host}}/file/{{.FileID}}" target="_blank"
     class="flex items-center gap-2 p-3 bg-base-200 rounded-lg hover:bg-base-300 transition-colors">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
    </svg>
    <span>{{if .Content}}{{.Content}}{{else}}Attached file{{end}}</span>
  </a>

  {{else if eq .Type "heading"}}
  <!-- Heading block -->
  <div class="block-content flex-1 outline-none min-h-[1.5em] text-2xl font-bold"
       contenteditable="true"
       data-placeholder="Heading">{{.Content}}</div>

  {{else if eq .Type "quote"}}
  <!-- Quote block -->
  <div class="block-content flex-1 outline-none min-h-[1.5em] border-l-4 border-white/20 pl-4 italic text-white/80"
       contenteditable="true"
       data-placeholder="Quote">{{.Content}}</div>

  {{else if eq .Type "code"}}
  <!-- Code block -->
  <div class="block-content flex-1 outline-none min-h-[1.5em] bg-base-200 p-4 rounded font-mono text-sm whitespace-pre-wrap"
       contenteditable="true"
       data-placeholder="Code">{{.Content}}</div>

  {{else if eq .Type "list"}}
  <!-- List block -->
  <div class="block-content flex-1 outline-none min-h-[1.5em]"
       contenteditable="true"
       data-placeholder="List item">{{.Content}}</div>

  {{else}}
  <!-- Paragraph block (default) -->
  <div class="block-content flex-1 outline-none min-h-[1.5em]"
       contenteditable="true"
       data-placeholder="Type '/' for commands...">{{.Content}}</div>
  {{end}}
</div>
