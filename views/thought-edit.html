<html data-theme="{{theme}}">

<head>
  {{template "includes.html"}}
  <title>{{if thoughts.CurrentThought}}Edit{{else}}New{{end}} Thought | The Skyscape</title>
</head>

<body>
  {{template "layout/start"}}

  {{$thought := thoughts.CurrentThought}}
  {{$isEdit := ne $thought nil}}
  {{$user := auth.CurrentUser}}

  <div class="max-w-screen-md w-full mx-auto px-4 py-8 md:py-12">
    <h1 class="text-2xl font-bold mb-8">{{if $isEdit}}Edit Thought{{else}}New Thought{{end}}</h1>

    <div class="error-message text-center text-error mb-4" role="alert" aria-live="polite"></div>

    <form
      {{if $isEdit}}
      hx-post="{{host}}/thought/{{$thought.ID}}"
      {{else}}
      hx-post="{{host}}/thoughts"
      {{end}}
      hx-target="previous .error-message" hx-swap="innerHTML"
      class="flex flex-col gap-6">

      <label class="floating-label">
        <input required name="title" type="text" class="input input-lg w-full" placeholder="Title"
          value="{{if $isEdit}}{{$thought.Title}}{{end}}">
        <span>Title</span>
      </label>

      <div class="flex flex-col gap-2">
        <label class="text-sm font-medium text-white/60">Content (Markdown supported)</label>
        <textarea required name="content" class="textarea textarea-bordered w-full min-h-96 font-mono text-sm"
          placeholder="Write your thought here using Markdown...">{{if $isEdit}}{{$thought.Content}}{{end}}</textarea>
      </div>

      <div class="flex items-center gap-2">
        <input type="checkbox" name="published" value="true" class="checkbox checkbox-primary"
          {{if and $isEdit $thought.Published}}checked{{end}}>
        <span class="text-sm">Publish immediately</span>
        <span class="text-xs text-white/40 ml-2">(uncheck to save as draft)</span>
      </div>

      <div class="flex items-center gap-4 mt-4">
        <button type="submit" class="btn btn-primary">
          {{if $isEdit}}Save Changes{{else}}Create Thought{{end}}
        </button>
        {{if $isEdit}}
        <a href="{{host}}/thought/{{$thought.ID}}" class="btn btn-ghost" hx-boost="true">Cancel</a>
        {{else}}
        <a href="{{host}}/thoughts" class="btn btn-ghost" hx-boost="true">Cancel</a>
        {{end}}
      </div>
    </form>
  </div>

  {{template "layout/end"}}
</body>

</html>
